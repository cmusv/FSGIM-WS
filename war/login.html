<html>
<head>
<title>FSGIM - Custom Query Manager - Login</title>
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" />
<link rel="stylesheet" href="../css/styles.css" />
<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="../js/messageNotification.js"></script>
<script type="text/javascript">
    // Convert the data on the page to JSON
    function dataToJSON() {
        return JSON.stringify({ userName : $("#userName").val(),
            password : $("#password").val() });
    }
    // Run this method when the page loads.
    $(document).ready(function() {
        $("#loginBtn").click(function() {            
            request = $.ajax({
                url: "/rest/login",
                type: "POST",
                contentType: 'application/json',
                dataType: 'json',
                data: dataToJSON()  
            });
            
            // callback handler that will be called on success
            request.done(function (response, textStatus, jqXHR){
                // Navigate to index.html page.
                console.log("User login successful !!!");
                localStorage.setItem("userId",response.id);
                localStorage.setItem("userName",response.userName);
                window.location.replace("index.html");
            });

            // callback handler that will be called on failure
            request.fail(function (jqXHR, textStatus, errorThrown){
                // log the error to the console
                console.error("The following error occured: "+ textStatus, 
                    errorThrown);
                
                showNotification("Error: "+ errorThrown);
            });
        });
    });
</script>
</head>
<body>
	<form id="loginForm">
		<table align="center">
			<thead align="center">
				<td colspan="2"><b>Please enter your credentials</b></td>
			</thead>
			<tr>
				<td>Username:</td>
				<td><input type="text" id="userName" /></td>
			</tr>
			<tr>
				<td>Password:</td>
				<td><input type="password" id="password" /></td>
			</tr>
			<tfoot>
				<td colspan="2" style="text-align: center;">
					<button id="loginBtn" type="button">Login</button>
					&nbsp;&nbsp;&nbsp;&nbsp;
					<button type="reset">Reset</button>
				</td>
			</tfoot>
		</table>
	</form>
</body>
</html>